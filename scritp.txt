ALTER TABLE db_millas_tts.destinos ADD ciudad varchar(100) NOT NULL ;
ALTER TABLE db_millas_tts.destinos CHANGE ciudad ciudad varchar(100) NOT NULL AFTER nombre ;
ALTER TABLE db_millas_tts.banner ADD data_json TEXT NULL ;

CREATE TABLE db_millas_tts.galeria_destino (
	id INTEGER NOT NULL AUTO_INCREMENT,
	id_destino INTEGER NOT NULL,
	id_imagen INTEGER NOT NULL,
	es_principal SMALLINT DEFAULT 0 NULL,
	CONSTRAINT galeria_destino_PK PRIMARY KEY (id),
	CONSTRAINT galeria_destino_imagenes_FK FOREIGN KEY (id_imagen) REFERENCES db_millas_tts.imagenes(id) ON DELETE RESTRICT,
	CONSTRAINT galeria_destino_destinos_FK FOREIGN KEY (id) REFERENCES db_millas_tts.destinos(id)
)
ENGINE=InnoDB
DEFAULT CHARSET=utf8
COLLATE=utf8_general_ci ;


CREATE TABLE db_millas_tts.galeria_promocion (
	id INTEGER NOT NULL AUTO_INCREMENT,
	id_promocion INTEGER NOT NULL,
	id_imagen INTEGER NOT NULL,
	es_principal SMALLINT DEFAULT 0 NULL,
	CONSTRAINT galeria_promocion_PK PRIMARY KEY (id),
	CONSTRAINT galeria_promocion_promociones_FK FOREIGN KEY (id_promocion) REFERENCES db_millas_tts.promociones(id) ON DELETE RESTRICT,
	CONSTRAINT galeria_promocion_imagenes_FK FOREIGN KEY (id_imagen) REFERENCES db_millas_tts.imagenes(id) ON DELETE RESTRICT
)
ENGINE=InnoDB
DEFAULT CHARSET=utf8
COLLATE=utf8_general_ci ;



CREATE TABLE `suscripciones` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `email` varchar(100) NOT NULL,
  `fecha_registro` datetime DEFAULT NULL,
  `status` smallint(6) DEFAULT '0',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

CREATE TABLE `destinos` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `nombre` varchar(100) NOT NULL,
  `ciudad` varchar(100) NOT NULL,
  `descripcion` text,
  `coodenadas` varchar(100) DEFAULT NULL,
  `id_galeria` int(11) DEFAULT NULL,
  `status` smallint(6) DEFAULT '0',
  `fecha_registro` date DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `destinos_galerias_FK` (`id_galeria`),
  CONSTRAINT `destinos_galerias_FK` FOREIGN KEY (`id`) REFERENCES `galeria_destino` (`id_destino`)
) ENGINE=InnoDB AUTO_INCREMENT=2 DEFAULT CHARSET=utf8;

CREATE TABLE `destinos` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `nombre` varchar(100) NOT NULL,
  `ciudad` varchar(100) NOT NULL,
  `descripcion` text,
  `coodenadas` varchar(100) DEFAULT NULL,
  `id_galeria` int(11) DEFAULT NULL,
  `status` smallint(6) DEFAULT '0',
  `fecha_registro` date DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `destinos_galerias_FK` (`id_galeria`),
  CONSTRAINT `destinos_galerias_FK` FOREIGN KEY (`id`) REFERENCES `galeria_destino` (`id_destino`)
) ENGINE=InnoDB AUTO_INCREMENT=2 DEFAULT CHARSET=utf8;



ALTER TABLE db_millas_tts.galeria_promocion ADD es_active SMALLINT DEFAULT 0 NULL ;


ALTER TABLE db_millas_tts.promociones ADD titulo varchar(100) NULL ;
ALTER TABLE db_millas_tts.promociones CHANGE titulo titulo varchar(100) NULL AFTER id_lugar ;
ALTER TABLE db_millas_tts.promociones ADD descripcion TEXT NULL ;
ALTER TABLE db_millas_tts.promociones CHANGE descripcion descripcion TEXT NULL AFTER titulo ;


ALTER TABLE db_millas_tts.banner ADD controlador varchar(30) NULL ;
ALTER TABLE db_millas_tts.banner ADD id_contralador INTEGER NULL ;

ALTER TABLE db_millas_tts.destinos DROP COLUMN id_galeria ;
ALTER TABLE db_millas_tts.destinos DROP FOREIGN KEY destinos_galerias_FK ;

ALTER TABLE db_millas_tts.galeria_destino DROP FOREIGN KEY galeria_destino_destinos_FK ;
ALTER TABLE db_millas_tts.galeria_destino ADD CONSTRAINT galeria_destino_destinos_FK FOREIGN KEY (id_destino) REFERENCES db_millas_tts.destinos(id) ON DELETE RESTRICT ;



